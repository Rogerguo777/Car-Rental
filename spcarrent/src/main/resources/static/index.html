<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <title>Gjun Rent | ç·šä¸Šç§Ÿè»Š</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <style>
        :root {
            /* èª¿æ•´ primary è‰²ç‚ºç¶ è‰² (#28a745)ï¼Œæ›´ç¬¦åˆç§Ÿè»Š/æ—…éŠçš„å°ˆæ¥­æ„Ÿ */
            --bs-primary-rgb: 40, 167, 69;
            --bs-primary: #28a745;
        }

        body {
            padding-top: 70px;
            background-color: #f4f7f9;
            /* è¼•å¾®çš„èƒŒæ™¯è‰²è®“å…§å®¹æ›´çªå‡º */
        }

        /* æœå°‹å€å¡Šæ¨£å¼ï¼šå¢åŠ æ¼¸å±¤å’Œé™°å½± */
        .search-header {
            background: linear-gradient(135deg, #e9ecef, #ffffff);
            border-bottom: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        /* å¡ç‰‡æ¨£å¼ï¼šåœ“è§’ã€é™°å½±ã€Hover æ•ˆæœ */
        .car-card {
            border-radius: 0.75rem;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .car-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .car-card img {
            height: 220px;
            /* èª¿æ•´åœ–ç‰‡é«˜åº¦ */
            object-fit: cover;
        }

        /* åƒ¹æ ¼æ¨™ç±¤æ¨£å¼ï¼šçªå‡ºé¡¯ç¤ºåƒ¹æ ¼ */
        .price-tag {
            font-size: 1.5rem;
            color: var(--bs-danger);
            /* åƒ¹æ ¼ä½¿ç”¨ç´…è‰²å¼·èª¿ */
            font-weight: bold;
        }

        /* èª¿æ•´è¨‚å–®æ‘˜è¦ä¸­çš„åƒ¹æ ¼å¤§å° */
        .price-tag-small {
            font-size: 1.25rem;
        }
    </style>
</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">Gjun Rent</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="index.html">é¦–é </a>
                    </li>

                    <li class="nav-item dropdown">
                        <button class="nav-link dropdown-toggle btn btn-link p-0" id="branchDropdown"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            æœå‹™æ“šé»
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="branchDropdown">
                            <li><a class="dropdown-item" href="branches.html?region=åŒ—éƒ¨">åŒ—éƒ¨ç§Ÿè»Š</a></li>
                            <li><a class="dropdown-item" href="branches.html?region=ä¸­éƒ¨">ä¸­éƒ¨ç§Ÿè»Š</a></li>
                            <li><a class="dropdown-item" href="branches.html?region=å—éƒ¨">å—éƒ¨ç§Ÿè»Š</a></li>
                            <li><a class="dropdown-item" href="branches.html?region=æ±éƒ¨">æ±éƒ¨ç§Ÿè»Š</a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="branches.html?region=ALL">æ‰€æœ‰æ“šé»</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-outline-light btn-sm ms-lg-3"
                            onclick="location.href='http://localhost:8080/reserve'">
                            é ç´„ç§Ÿè»Š
                        </button>
                    </li>
                    
                     <li class="nav-item">
                        <button class="btn btn-outline-light btn-sm ms-lg-3"
                            onclick="location.href='attach-driver.html'">
                            é™„é§•æœå‹™
                        </button>
                    </li>

                    <li class="nav-item">
                        <button class="btn btn-outline-light btn-sm ms-lg-3"
                            onclick="location.href='http://localhost:8080/my-orders'">
                            æˆ‘çš„è¨‚å–®
                        </button>
                    </li>

                    <li class="nav-item">
                        <button class="btn btn-outline-light btn-sm ms-lg-3" data-bs-toggle="modal"
                            data-bs-target="#loginModal">
                            æœƒå“¡ç™»å…¥
                        </button>
                    </li>
                </ul>

            </div>
        </div>
    </nav>

    <header class="search-header">
        <div class="container py-4 py-md-5">
            <h1 class="display-6 fw-bold mb-1">
                è¼•é¬†ç§Ÿè»Šï¼Œå±•é–‹æ‚¨çš„æ—…ç¨‹ï¼
            </h1>
            <p class="lead mb-4 text-muted">æ•¸ç™¾æ¬¾è»Šå‹ä»»æ‚¨æŒ‘é¸ï¼Œç«‹å³ç·šä¸Šé ç´„ã€‚</p>

            <form id="search-form" class="row gy-3 gx-3 align-items-end p-3 bg-white rounded-3 shadow">

                <div class="col-lg-3 col-md-6">
                    <label for="pickupLocation" class="form-label small fw-bold text-muted">ğŸ“ å–è»Šåˆ†åº—</label>
                    <select class="form-select form-select-lg" id="pickupLocation">
                        <option value="">ä¸é™</option>
                        <option value="taipei">å°åŒ—</option>
                        <option value="HsinChu">æ–°ç«¹</option>
                        <option value="Taichung">å°ä¸­</option>
                        <option value="kaoSiung">é«˜é›„</option>
                    </select>
                </div>

                <div class="col-lg-3 col-md-6">
                    <label for="pickupDate" class="form-label small fw-bold text-muted">ğŸ—“ï¸ å–è»Šæ—¥æœŸ</label>
                    <input type="date" class="form-control form-control-lg" id="pickupDate">
                </div>

                <div class="col-lg-3 col-md-6">
                    <label for="returnDate" class="form-label small fw-bold text-muted">ğŸ—“ï¸ é‚„è»Šæ—¥æœŸ</label>
                    <input type="date" class="form-control form-control-lg" id="returnDate">
                </div>

                <div class="col-lg-2 col-md-6">
                    <label for="carType" class="form-label small fw-bold text-muted">ğŸš— è»Šå‹</label>
                    <select class="form-select form-select-lg" id="carType">
                        <option value="">ä¸é™</option>
                        <option value="eco">ç¶“æ¿Ÿå°å‹è»Š</option>
                        <option value="sedan">ä¸­å‹æˆ¿è»Š</option>
                        <option value="suv">SUV</option>
                        <option value="van">ä¸ƒäººåº§</option>
                    </select>
                </div>

                <div class="col-lg-1 col-12 d-grid">
                    <button type="button" id="searchBtn" class="btn btn-primary btn-lg">
                        <i class="bi bi-search"></i>
                    </button>
                </div>
            </form>
        </div>
    </header>

    <main class="container my-5">
        <div class="row g-4">

            <div class="col-lg-4 order-lg-2">
                <div class="card shadow-sm position-sticky" style="top: 80px;">
                    <div class="card-header bg-primary text-white fw-bold">
                        ğŸ›’ è¨‚å–®æ‘˜è¦
                    </div>
                    <div class="card-body" id="booking-summary">
                        <p class="text-muted mb-1">å°šæœªé¸æ“‡è»Šè¼›</p>
                        <small class="text-muted">è«‹å¾å·¦å´åˆ—è¡¨é¸æ“‡ä¸€å°è»Šï¼Œå³å¯é–‹å§‹é ç´„ã€‚</small>
                    </div>
                </div>
            </div>

            <div class="col-lg-8 order-lg-1">
                <h2 class="h5 mb-4 border-bottom pb-2">âœ… æœå°‹çµæœ</h2>
                <div id="car-list" class="row g-4">
                </div>
            </div>

        </div>
    </main>

    <div class="modal fade" id="bookingModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ç¢ºèªé ç´„</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="modal-car-name" class="fw-bold"></p>
                    <p id="modal-car-info" class="mb-2"></p>
                    <p id="modal-date-info" class="text-muted small"></p>

                    <hr>
                    <div class="mb-3">
                        <label class="form-label">ç§Ÿè»Šäººå§“å</label>
                        <input type="text" class="form-control" id="customerName" placeholder="è«‹è¼¸å…¥çœŸå¯¦å§“å">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">è¯çµ¡é›»è©±</label>
                        <input type="tel" class="form-control" id="customerPhone" placeholder="09xx-xxx-xxx">
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" name="babycart" class="form-check-input" id="addItem_1">
                        <label class="form-check-label">åŠ è³¼å¬°å…’è»Š (+NT$ 300)</label>
                    </div>

                    <div class="mb-3 form-check">
                        <input type="checkbox" name="insurance" class="form-check-input" id="addItem_2">
                        <label class="form-check-label">åŠ è³¼å®‰å¿ƒè»Šéšª (+NT$ 500/æ—¥)</label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" id="confirmBookingBtn">
                        ç¢ºèªé ç´„
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">æœƒå“¡ç™»å…¥</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="loginEmail" placeholder="example@email.com"
                                required>
                        </div>

                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">å¯†ç¢¼</label>
                            <input type="password" class="form-control" id="loginPassword" placeholder="è«‹è¼¸å…¥å¯†ç¢¼" required>
                        </div>

                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="rememberMe">
                                <label class="form-check-label" for="rememberMe">
                                    è¨˜ä½æˆ‘
                                </label>
                            </div>
                            <a href="#" class="small">å¿˜è¨˜å¯†ç¢¼ï¼Ÿ</a>
                        </div>

                        <div class="alert alert-danger py-2 px-3 d-none" id="loginError">
                            ç™»å…¥å¤±æ•—ï¼Œè«‹ç¢ºèªå¸³è™Ÿæˆ–å¯†ç¢¼ã€‚
                        </div>
                    </form>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">é—œé–‰</button>
                    <button type="button" class="btn btn-primary" id="loginSubmitBtn">
                        ç™»å…¥
                    </button>
                </div>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>

        // å‡ç™»å…¥é‚è¼¯ï¼ˆä¸è®Šï¼‰
        document.getElementById("loginSubmitBtn").addEventListener("click", function () {
            const email = document.getElementById("loginEmail").value.trim();
            const password = document.getElementById("loginPassword").value.trim();
            const errorBox = document.getElementById("loginError");

            if (!email || !password) {
                errorBox.classList.remove("d-none");
                errorBox.textContent = "è«‹è¼¸å…¥ Email å’Œå¯†ç¢¼ã€‚";
                return;
            }

            if (email === "test@example.com" && password === "123456") {
                errorBox.classList.add("d-none");
                alert("ç™»å…¥æˆåŠŸï¼ˆç›®å‰ç‚ºå‰ç«¯æ¸¬è©¦ç”¨ï¼‰");

                const modalEl = document.getElementById("loginModal");
                const modal = bootstrap.Modal.getInstance(modalEl);
                modal.hide();
            } else {
                errorBox.classList.remove("d-none");
                errorBox.textContent = "ç™»å…¥å¤±æ•—ï¼Œè«‹ç¢ºèªå¸³è™Ÿæˆ–å¯†ç¢¼ã€‚";
            }
        });


        // âœ ä¹‹å¾Œå¯ä»¥æ”¹æˆå¾ /api/cars å–å¾—
        const sampleCars = [
            {
                id: 1,
                name: "Toyota Vios æˆ–åŒç´š",
                type: "eco",
                pricePerDay: 1200,
                seats: 5,
                luggage: 2,
                imageUrl: "./imgs/ToYoTa.jpeg"
            },
            {
                id: 2,
                name: "Honda Civic æˆ–åŒç´š",
                type: "sedan",
                pricePerDay: 1800,
                seats: 5,
                luggage: 3,
                imageUrl: "./imgs/Honda.jpeg"
            },
            {
                id: 3,
                name: "Toyota RAV4 æˆ–åŒç´š",
                type: "suv",
                pricePerDay: 2400,
                seats: 5,
                luggage: 4,
                imageUrl: "./imgs/Toyota RAV4.jpeg"
            },
            {
                id: 4,
                name: "Volkswagen T6 ä¹äººåº§",
                type: "van",
                pricePerDay: 3200,
                seats: 9,
                luggage: 5,
                imageUrl: "./imgs/Volkswagen T6.jpeg"
            }
        ];

        let selectedCar = null;

        // æ¸²æŸ“è»Šè¼›å¡ç‰‡ (æ›´æ–°å¾Œçš„å‡½å¼ï¼Œä½¿ç”¨æ–°æ¨£å¼)
        function renderCars(cars) {
            const carList = document.getElementById("car-list");
            carList.innerHTML = "";

            if (!cars || cars.length === 0) {
                carList.innerHTML = '<p class="text-muted">æ²’æœ‰ç¬¦åˆæ¢ä»¶çš„è»Šè¼›ã€‚</p>';
                return;
            }

            cars.forEach(car => {
                const col = document.createElement("div");
                col.className = "col-md-6";

                col.innerHTML = `
                <div class="card car-card h-100 shadow-sm">
                    <img src="${car.imageUrl}" class="card-img-top" alt="${car.name}">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title fw-bold text-truncate">${car.name}</h5>

                        <div class="mb-3 small text-muted">
                            <span class="me-3"><i class="bi bi-people-fill"></i> ${car.seats} äººåº§</span>
                            <span><i class="bi bi-bag-fill"></i> ${car.luggage} ä»¶è¡Œæ</span>
                        </div>

                        <div class="d-flex justify-content-between align-items-center mt-auto mb-3">
                            <div>
                                <span class="price-tag">
                                    NT$ ${car.pricePerDay}
                                </span>
                                <span class="text-muted small">/ æ—¥èµ·</span>
                            </div>
                            <span class="badge bg-secondary-subtle text-secondary">${car.type.toUpperCase()}</span>
                        </div>

                        <button class="btn btn-danger btn-lg"
                                onclick="openBooking(${car.id})">
                            ç«‹å³é ç´„
                        </button>
                    </div>
                </div>
            `;
                carList.appendChild(col);
            });
        }

        // é–‹å•Ÿé ç´„è¦–çª— (æ›´æ–°å³å´æ‘˜è¦é‚è¼¯)
        function openBooking(carId) {
            selectedCar = sampleCars.find(c => c.id === carId);
            if (!selectedCar) return;

            // å–å¾—åˆ†åº—åç¨± (ç”¨æ–¼æ‘˜è¦å’Œ Modal)
            const locElement = document.getElementById("pickupLocation");
            const loc = locElement.options[locElement.selectedIndex].text || "(æœªé¸å–å–è»Šåˆ†åº—)";

            const pickup = document.getElementById("pickupDate").value || "(æœªé¸å–)";
            const ret = document.getElementById("returnDate").value || "(æœªé¸å–)";

            // æ›´æ–° Modal å…§å®¹
            document.getElementById("modal-car-name").innerText = selectedCar.name;
            document.getElementById("modal-car-info").innerText =
                `NT$ ${selectedCar.pricePerDay} / æ—¥ï¼Œ${selectedCar.seats} äººåº§ï¼Œè¡Œæ ${selectedCar.luggage} ä»¶`;

            document.getElementById("modal-date-info").innerHTML =
                `ğŸ“ å–è»Šåˆ†åº—ï¼š${loc}<br>
                 ğŸ—“ï¸ ç§ŸæœŸï¼š${pickup} ~ ${ret}`;

            // æ›´æ–°å³å´æ‘˜è¦ (ä½¿ç”¨æ›´æ¸…æ™°çš„ HTML çµæ§‹)
            const summary = document.getElementById("booking-summary");
            summary.innerHTML = `
                <p class="mb-1 fw-bold">${selectedCar.name}</p>
                <p class="mb-2 text-danger price-tag-small">NT$ ${selectedCar.pricePerDay} / æ—¥</p>
                <hr>
                <p class="small mb-1"><i class="bi bi-geo-alt-fill text-primary"></i> å–è»Šåˆ†åº—ï¼š${loc}</p>
                <p class="small mb-1"><i class="bi bi-calendar-check-fill text-primary"></i> å–è»Šæ—¥æœŸï¼š${pickup}</p>
                <p class="small mb-2"><i class="bi bi-calendar-check-fill text-primary"></i> é‚„è»Šæ—¥æœŸï¼š${ret}</p>
                
                <button class="btn btn-sm btn-primary w-100 mt-2" data-bs-toggle="modal"
                        data-bs-target="#bookingModal">
                    å¡«å¯«é ç´„è³‡æ–™
                </button>
            `;
        }

        // ç›£è½æœå°‹æŒ‰éˆ•ï¼ˆç›®å‰åªåšå‰ç«¯ç¯©é¸ï¼‰
        document.getElementById("searchBtn").addEventListener("click", function () {
            const type = document.getElementById("carType").value;
            const pickupLoc = document.getElementById("pickupLocation").value;

            // å¯¦å‹™ä¸Šé€™è£¡æœƒå‘¼å«å¾Œç«¯ API
            let filtered = sampleCars;
            if (type) {
                filtered = filtered.filter(c => c.type === type);
            }
            // è¨»ï¼šé€™è£¡æ²’æœ‰å¯¦ä½œæ—¥æœŸå’Œåˆ†åº—çš„å‡ç¯©é¸ï¼Œå¯¦å‹™ä¸Šæ‡‰ç”±å¾Œç«¯è™•ç†ã€‚

            renderCars(filtered);
        });

        // å‡çš„é ç´„é€å‡ºï¼ˆå°‡è·³è½‰åˆ°è¨‚å–®é ï¼‰
        document.getElementById("confirmBookingBtn").addEventListener("click", function () {
            const name = document.getElementById("customerName").value.trim();
            const phone = document.getElementById("customerPhone").value.trim();

            if (!name || !phone) {
                alert("è«‹è¼¸å…¥å§“åèˆ‡é›»è©±");
                return;
            }

            // âœ æœªä¾†ä½ å¯ä»¥åœ¨é€™è£¡å‘¼å«å¾Œç«¯ POST /api/bookings
            alert("é ç´„æˆåŠŸï¼ç›®å‰æ˜¯å‰ç«¯å‡é ç´„ï¼Œä¹‹å¾Œå¯ä»¥æ¥ä¸Š RESTful å¾Œç«¯ä¸¦é¡¯ç¤ºè¨‚å–®ç·¨è™Ÿã€‚");

            const modalEl = document.getElementById("bookingModal");
            const modal = bootstrap.Modal.getInstance(modalEl);
            modal.hide();

            // å°å‘æˆ‘çš„è¨‚å–®é é¢
            window.location.href = 'mambers.html';
        });

        // é é¢è¼‰å…¥æ™‚çš„åˆå§‹åŒ–å‹•ä½œ
        document.addEventListener("DOMContentLoaded", function () {
            renderCars(sampleCars);

            // 1. UX å„ªåŒ–ï¼šé è¨­å°‡å–è»Šæ—¥æœŸæœ€å°å€¼è¨­ç‚ºä»Šå¤©
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('pickupDate').min = today;

            // 2. UX å„ªåŒ–ï¼šç¢ºä¿é‚„è»Šæ—¥æœŸä¸èƒ½æ—©æ–¼å–è»Šæ—¥æœŸ
            const pickupDateEl = document.getElementById('pickupDate');
            const returnDateEl = document.getElementById('returnDate');

            pickupDateEl.addEventListener('change', function () {
                returnDateEl.min = this.value;
                if (returnDateEl.value < this.value) {
                    returnDateEl.value = this.value;
                }
            });
        });
    </script>

</body>

</html>